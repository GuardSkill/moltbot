# 国内 Linux/Windows 版本设置指南

本版本优化了网关启动和LLM的代理问题，可以支持在linux容器上部署，以及国内的windows电脑部署。

## 1. 卸载原版并安装代理版

```bash
npm uninstall -g clawdbot moltbot
npm install -g @guadskill/moltbot-proxy
```

## 2. LLM 代理配置（非mac必须配置）

前提：需要开启 Clash，并设置端口为 7890

### 方法 1：配置文件（推荐）

配置文件路径：
- **Linux**: `~/.moltbot/moltbot.json`
- **Windows**: `C:\Users\{你的用户}\.moltbot\moltbot.json`

```yaml
agents:
  defaults:
    "proxy": "http://127.0.0.1:7890",
    ....
```

### 方法 2：环境变量（windows未验证）

**Linux/macOS:**

```bash
export HTTPS_PROXY=http://127.0.0.1:7890
export HTTP_PROXY=http://127.0.0.1:7890
```

**Windows (PowerShell):**

```powershell
$env:HTTPS_PROXY="http://127.0.0.1:7890"
$env:HTTP_PROXY="http://127.0.0.1:7890"
```

> 注意：配置文件优先级高于环境变量。

## 3. 重新 onboard 并启动

```bash
moltbot onboard --install-daemon


（出了问题再看看网关对不对）
moltbot gateway run
```

启动成功后会在日志中看到：

```
gateway: HTTP proxy enabled: http://127.0.0.1:7890
```

所有 LLM API 请求（OpenAI、Anthropic、Google 等）都会通过指定的代理发送。

## 4. Telegram 代理配置

linux容器
```bash
clawdbot config set channels.telegram.proxy "http://127.0.0.1:7890"
pm2 start clawdbot --name clawd-gateway -- gateway run
pm2 restart moltbot-gateway
```

windows
```bash
moltbot config set channels.telegram.proxy "http://127.0.0.1:7890"
moltbot gateway run
```

有人之前把这个关了，需要再onborad前启动一下
```bash
 moltbot config set channels.telegram.enabled true
```

pair telegram
```bash
moltbot pairing approve telegram L8HTxxxHW8T
```